in here only sin exp and cos functions are changed, the rest is in double 
